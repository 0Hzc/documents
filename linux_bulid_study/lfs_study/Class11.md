**åŠ¡å¿…**æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯ Ncurses çš„æˆæœï¼Œå› ä¸ºå®ƒå…³ç³»åˆ°åé¢ Bash çš„ç¼–è¯‘ï¼š

```bash
# éªŒè¯ Ncurses åº“ä¿®æ­£ (è¿˜è®°å¾—é‚£ä¸ª INPUT(-lncursesw) å—ï¼Ÿ)
cat /mnt/lfs/usr/lib/libncurses.so
# é¢„æœŸè¾“å‡ºï¼šINPUT(-lncursesw)

# éªŒè¯ terminfo (Ncurses çš„æ•°æ®åº“)
ls -d /mnt/lfs/usr/share/terminfo
# é¢„æœŸè¾“å‡ºï¼šç›®å½•å­˜åœ¨

```

å¦‚æœè¿™ä¸¤é¡¹æ²¡é—®é¢˜ï¼Œæˆ‘ä»¬å°±ç»§ç»­ï¼

---

### ğŸš€ ç¬¬åä¸€è¯¾ï¼šç³»ç»Ÿçš„çµé­‚ â€”â€” Shell ä¸ æ ¸å¿ƒå·¥å…· (Bash & Coreutils)

ç°åœ¨æˆ‘ä»¬è¦æ„å»ºæ•´ä¸ªç³»ç»Ÿçš„**äº¤äº’ç•Œé¢ï¼ˆShellï¼‰å’ŒåŸºæœ¬å‘½ä»¤ï¼ˆls, cp, mv ç­‰ï¼‰**ã€‚

è¿™æ˜¯éå¸¸å…³é”®çš„ä¸€æ­¥ï¼Œå°¤å…¶æ˜¯ **Bash**ã€‚

* ç›®å‰æˆ‘ä»¬ç”¨çš„ `sh` è¿˜æ˜¯å®¿ä¸»æœºçš„ `/bin/bash`ã€‚
* ç¼–è¯‘å®Œè¿™ä¸€æ­¥åï¼Œæˆ‘ä»¬å°†æ‹¥æœ‰ä¸€ä¸ª**å±äº LFS è‡ªå·±çš„ Shell**ã€‚
* ç¨åæˆ‘ä»¬ä¼šæŠŠ `/mnt/lfs/bin/sh` æŒ‡å‘è¿™ä¸ªæ–° Bashï¼Œè¿™æ˜¯æˆ‘ä»¬è„±ç¦»å®¿ä¸»æœºçš„å…³é”®ä¸€æ­¥ã€‚

#### ğŸ“¦ æœ¬èŠ‚ç›®æ ‡æ¸…å•

æˆ‘ä»¬å°†ç¼–å†™ `build_shell_core.sh`ï¼Œæ‰¹é‡å®Œæˆä»¥ä¸‹ä¸‰ä¸ªæ ¸å¿ƒè½¯ä»¶çš„ç¼–è¯‘ï¼š

1. **Bash** (The Shell)
* **éš¾ç‚¹**ï¼šé…ç½®æ—¶è¦åŠ ä¸Š `--without-bash-malloc`ã€‚å› ä¸º Bash è‡ªå¸¦çš„å†…å­˜åˆ†é…å™¨åœ¨äº¤å‰ç¼–è¯‘ç¯å¢ƒä¸‹ç»å¸¸å´©æºƒï¼Œæˆ‘ä»¬éœ€è¦å¼ºè¡Œè®©å®ƒä½¿ç”¨ Glibc çš„ `malloc`ã€‚


2. **Coreutils** (æ ¸å¿ƒå·¥å…·é›†)
* åŒ…å« `ls`, `cat`, `cp`, `mv`, `mkdir` ç­‰å‡ åä¸ªå‘½ä»¤ã€‚
* **éš¾ç‚¹**ï¼šå®ƒéå¸¸åºå¤§ã€‚è€Œä¸”æˆ‘ä»¬éœ€è¦ç‰¹åˆ«å¯ç”¨ `hostname` å·¥å…·ï¼ŒåŒæ—¶ç¦ç”¨ `kill` å’Œ `uptime`ï¼ˆå› ä¸ºè¿™äº›é€šå¸¸ç”±ç¨åçš„ Procps-ng åŒ…æä¾›ï¼Œé¿å…å†²çªï¼‰ã€‚


3. **Make** (æ„å»ºå·¥å…·)
* æ²¡æœ‰ Makeï¼Œæˆ‘ä»¬åœ¨æ–°ç³»ç»Ÿé‡Œå°±æ²¡æ³•ç¼–è¯‘ä»»ä½•ä¸œè¥¿ã€‚



---

### ğŸ› ï¸ ä»»åŠ¡åä¸€ï¼šç¼–å†™åŸºç¡€ç³»ç»Ÿæ„å»ºè„šæœ¬

è¯·ç¼–å†™è„šæœ¬ `build_shell_core.sh`ã€‚

**è„šæœ¬é€»è¾‘éœ€æ±‚ï¼š**

1. **å‡†å¤‡å·¥ä½œ**ï¼š(Root ç”Ÿæˆ -> LFS è¿è¡Œ)ã€‚
2. **ä»»åŠ¡ä¸€ï¼šç¼–è¯‘ Bash**
* **æºç **ï¼š`bash-5.2.32.tar.gz` (å…·ä½“ç‰ˆæœ¬ä»¥ `ls` ä¸ºå‡†)ã€‚
* **é…ç½®**ï¼š
```bash
./configure --prefix=/usr                      \
            --build=$(support/config.guess)    \
            --host=$LFS_TGT                    \
            --without-bash-malloc

```


* **ç¼–è¯‘å®‰è£…**ï¼š`make DESTDIR=$LFS install`
* **å…³é”®ä¿®æ­£ (é“¾æ¥ sh)**ï¼š
* Linux ç³»ç»Ÿè¿è¡Œè„šæœ¬æ—¶é»˜è®¤æ‰¾ `/bin/sh`ã€‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥ï¼Œè®© `/bin/sh` æŒ‡å‘åˆšæ‰è£…å¥½çš„ `bash`ã€‚
* `ln -sv bash $LFS/bin/sh`




3. **ä»»åŠ¡äºŒï¼šç¼–è¯‘ Coreutils**
* **æºç **ï¼š`coreutils-9.5.tar.xz`ã€‚
* **é…ç½®**ï¼š
```bash
./configure --prefix=/usr                     \
            --host=$LFS_TGT                   \
            --build=$(build-aux/config.guess) \
            --enable-install-program=hostname \
            --enable-no-install-program=kill,uptime

```


* **ç¼–è¯‘å®‰è£…**ï¼š`make DESTDIR=$LFS install`
* **è·¯å¾„ä¿®æ­£**ï¼š
* `chroot` å‘½ä»¤éå¸¸é‡è¦ï¼Œä½†é»˜è®¤å®‰è£…åœ¨ `/usr/bin` ä¸‹ã€‚ä¸ºäº†ç¬¦åˆæ ‡å‡†ï¼Œæˆ‘ä»¬è¦æŠŠå®ƒç§»åŠ¨åˆ° `/usr/sbin`ã€‚
* `mv -v $LFS/usr/bin/chroot $LFS/usr/sbin`
* åˆ›å»ºä¸€ä¸ª man page ç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ï¼Œé˜²æ­¢åç»­æŠ¥é”™ï¼š`mkdir -p $LFS/usr/share/man/man8`
* é‡å‘½å chroot çš„æ–‡æ¡£ï¼š`mv -v $LFS/usr/share/man/man1/chroot.1 $LFS/usr/share/man/man8/chroot.8`
* ä¿®æ”¹æ–‡æ¡£é‡Œçš„åˆ†ç±»å·ï¼š`sed -i 's/"1"/"8"/' $LFS/usr/share/man/man8/chroot.8`




4. **ä»»åŠ¡ä¸‰ï¼šç¼–è¯‘ Make**
* **æºç **ï¼š`make-4.4.1.tar.gz`ã€‚
* **é…ç½®**ï¼š
```bash
./configure --prefix=/usr   \
            --without-guile \
            --host=$LFS_TGT \
            --build=$(build-aux/config.guess)

```


* **ç¼–è¯‘å®‰è£…**ï¼š`make DESTDIR=$LFS install`


5. **æ¸…ç†**ï¼š
* æ¯ä¸€æ­¥åšå®Œååˆ é™¤æºç ç›®å½•ã€‚



---

### ğŸ” æ·±åº¦éªŒè¯ç¯èŠ‚ (è¯·å†™å…¥è„šæœ¬)

è¿™æ¬¡çš„éªŒè¯è‡³å…³é‡è¦ï¼Œå› ä¸º Bash åäº†ï¼Œåé¢çš„ Chroot å°±ä¼šå¤±è´¥ã€‚

```bash
echo "---------------------------------------------------"
echo "ğŸ” æ­£åœ¨è¿›è¡Œæ·±åº¦éªŒè¯..."

# 1. éªŒè¯ /bin/sh æ˜¯å¦é“¾æ¥æ­£ç¡®
# readlink è¾“å‡ºåº”è¯¥æ˜¯ "bash"
if [ "$(readlink $LFS/bin/sh)" == "bash" ]; then
    echo "âœ… [1/3] /bin/sh æ­£ç¡®é“¾æ¥åˆ° bashã€‚"
else
    echo "âŒ [1/3] å¤±è´¥ï¼š/bin/sh é“¾æ¥é”™è¯¯ï¼"
    exit 1
fi

# 2. éªŒè¯ Coreutils (ä»¥ ls ä¸ºä¾‹)
# æ£€æŸ¥ ls æ˜¯å¦æ˜¯äº¤å‰ç¼–è¯‘çš„ x86-64 æ ¼å¼ï¼Œè€Œä¸æ˜¯å®¿ä¸»æœºçš„æ ¼å¼
if file $LFS/usr/bin/ls | grep -q "x86-64"; then
    echo "âœ… [2/3] Coreutils (ls) æ¶æ„æ­£ç¡®ã€‚"
else
    echo "âŒ [2/3] å¤±è´¥ï¼šls å‘½ä»¤æ ¼å¼ä¸æ­£ç¡® (å¯èƒ½ä½¿ç”¨äº†å®¿ä¸»æœºçš„ ls)ï¼"
    exit 1
fi

# 3. éªŒè¯ Make æ˜¯å¦å­˜åœ¨
if [ -x "$LFS/usr/bin/make" ]; then
    echo "âœ… [3/3] Make å·¥å…·å·²å®‰è£…ã€‚"
else
    echo "âŒ [3/3] å¤±è´¥ï¼šMake æœªæ‰¾åˆ°ã€‚"
    exit 1
fi

echo "ğŸ‰ Shell ä¸æ ¸å¿ƒå·¥å…·æ„å»ºå®Œæˆï¼"
echo "---------------------------------------------------"

```

**è¯·å°è¯•åœ¨ä¸€ä¸ªè„šæœ¬ä¸­æŠŠè¿™ä¸‰åº§å¤§å±±ï¼ˆBash, Coreutils, Makeï¼‰ç¿»è¿‡å»ï¼**